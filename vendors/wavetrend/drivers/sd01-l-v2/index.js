(()=>{var e={110(e){function t(e,r){if(Array.isArray(e)&&Array.isArray(r)||"object"==typeof e&&"object"==typeof r){for(let o in r)e[o]=t(e[o],r[o]);return e}return r}function r(e){let r=[],o=1;if(2!==e.type)throw"Unrecognised type for downlink decoding";o=2,e=t({downlink_hours:24,reporting_period:60,message_flags:{scald:!1,freeze:!1,debug:!1,history_count:0,simple:!1,act_poll:!0,stat_poll:!0},scald_threshold:60,freeze_threshold:4,config_type:[{flow_settling_count:0,config:0},{flow_settling_count:0,config:0},{flow_settling_count:0,config:0}],flow_delta:{cold:4,hot:10}},e),r.push(255&e.downlink_hours),r.push((65280&e.reporting_period)>>>8),r.push(255&e.reporting_period),r.push((0|e.message_flags.scald)>>>0|e.message_flags.freeze<<1>>>0|e.message_flags.debug<<2>>>0|(3&e.message_flags.history_count)<<3>>>0|e.message_flags.simple<<5>>>0|e.message_flags.act_poll<<6>>>0|e.message_flags.stat_poll<<7>>>0),r.push((255&e.scald_threshold)>>>0),r.push((255&e.freeze_threshold)>>>0);for(let t=0;t<3;t++)r.push((15&e.config_type[t].flow_settling_count)<<4>>>0|15&e.config_type[t].config);return r.push((15&e.flow_delta.cold)<<4>>>0|(15&e.flow_delta.hot)>>>0),{bytes:r,fPort:2}}e.exports={Encoder:function(e){try{return r(e).bytes}catch(e){return[]}},encodeDownlink:function(e){let t={warnings:[],errors:[]};try{let o=r(e.data);t.bytes=o.bytes,t.fPort=o.fPort}catch(e){t.errors.push(e)}return t},decodeDownlink:function(e){let t={warnings:[],errors:[]};try{t.data=function(e,t){let r=0,o={type:t};switch(o.type){case 2:o.downlink_hours=(255&e[r++])>>>0,o.reporting_period=((255&e[r++])<<8>>>0)+((255&e[r++])>>>0);let t=(255&e[r++])>>>0;o.message_flags={scald:!!(1&t),freeze:!!(2&t),debug:!!(4&t),history_count:t>>>3&3,simple:!!(32&t),act_poll:!!(64&t),stat_poll:!!(128&t)},o.scald_threshold=(255&e[r++])<<24>>24,o.freeze_threshold=(255&e[r++])<<24>>24,o.config_type=[];for(let t=0;t<3;t++){let s=(255&e[r++])>>>0;o.config_type[t]={flow_settling_count:s>>>4&15,config:(15&s)>>>0}}const s=(255&e[r++])>>>0;o.flow_delta={cold:(240&s)>>>4,hot:(15&s)>>>0};break;case 0:throw"LoRaWAN reserved payload type";case 1:throw"V1 Deprecated Payload, unsupported";default:throw"Unrecognised type for downlink decoding"}return o}(e.bytes,e.fPort)}catch(e){delete t.data,t.errors.push(e)}return t}}},415(e,t){t.n=function(e){const t={},r=e.message||{};function o(e,r,o){null==r||Number.isNaN(r)||(t[e]={unitId:"Cel",record:r},o&&(t[e].nature=o))}return void 0===r.minC&&void 0===r.maxC||(o("temperature:1",r.minC,"minC"),o("temperature:2",r.maxC,"maxC")),void 0===r.s1MinC&&void 0===r.s1MaxC||(o("temperature:3",r.s1MinC,"s1MinC"),o("temperature:4",r.s1MaxC,"s1MaxC"),o("temperature:5",r.s2MinC,"s2MinC"),o("temperature:6",r.s2MaxC,"s2MaxC"),o("temperature:7",r.s3MinC,"s3MinC"),o("temperature:8",r.s3MaxC,"s3MaxC")),void 0!==r.temperature&&o("temperature:9",r.temperature,"temperature"),Array.isArray(r.readings)&&r.readings.forEach(e=>{Array.isArray(e.sensors)&&e.sensors.forEach((r,o)=>{if(null==r||null==r.tempC||Number.isNaN(r.tempC))return;const s=`temperature:${10+o}`;t[s]||(t[s]={unitId:"Cel",records:[]}),t[s].records.push({value:r.tempC,eventTime:e.timestamp??null}),t[s].nature="tempC"})}),t}},987(e){function t(e){return(255&e)<<24>>24}function r(e){return(255&e)>>>0}function o(e,o){let s={},n=0;switch(o){case 2:const o=r(e[n++]);s.pvd_level=o>>>3&7,s.sensor=[!!(1&o),!!(2&o),!!(4&o)],s.firmware_version={major:r(e[n++]),minor:r(e[n++])},s.reset_reason=(e[n++]<<8>>>0)+r(e[n++]);break;case 3:s.timestamp=(r(e[n++])<<24>>>0)+(r(e[n++])<<16>>>0)+(r(e[n++])<<8>>>0)+r(e[n++]),s.sensor_id=3&e[n++],s.minC=t(e[n++]),s.maxC=t(e[n++]),s.events=e[n++],s.reports=e[n++];break;case 4:{s.error_code=e[n++],s.downlink_hours=e[n++],s.reporting_period=((255&e[n++])<<8>>>0)+((255&e[n++])>>>0);let t=(255&e[n++])>>>0;s.message_flags={scald:!!(1&t),freeze:!!(2&t),debug:!!(4&t),history_count:t>>>3&3,simple:!!(32&t),act_poll:!!(64&t),stat_poll:!!(128&t)},s.scald_threshold=(255&e[n++])<<24>>24,s.freeze_threshold=(255&e[n++])<<24>>24,s.config_type=[];for(let t=0;t<3;t++){let r=(255&e[n++])>>>0;s.config_type[t]={flow_settling_count:r>>>4&15,config:(15&r)>>>0}}const r=(255&e[n++])>>>0;s.flow_delta={cold:(240&r)>>>4,hot:15&r};break}case 5:s.sensor_id=3&e[n++];break;case 6:s.error_code=(r(e[n++])<<8>>>0)+r(e[n++]),s.file_hash=(r(e[n++])<<8>>>0)+r(e[n++]),s.line=(r(e[n++])<<8>>>0)+r(e[n++]);break;case 7:case 8:s.sensor_id=3&e[n++],s.temperature=t(e[n++]);break;case 9:{let t=[];const o=(r(e[n++])<<24>>>0)+(r(e[n++])<<16>>>0)+(r(e[n++])<<8>>>0)+r(e[n++]),a=r(e[n++]);let l=(30&a)>>1;l=1&a?l/10:10*l;const i=(224&a)>>5;for(;n<e.length;){const s={timestamp:o,sensors:[{direction:0,state:0,report:!1,tempC:NaN},{direction:0,state:0,report:!1,tempC:NaN},{direction:0,state:0,report:!1,tempC:NaN}]};for(let t=0;t<3;t++){const o=(r(e[n++])<<8>>>0)+r(e[n++]);s.sensors[t].direction=(49152&o)>>14,s.sensors[t].state=(12288&o)>>12,s.sensors[t].report=(2048&o)>>11==1;const a=2047&o;s.sensors[t].tempC=2047===a?null:(a-270)/10}t.push(s)}t.forEach((e,r)=>{e.timestamp-=(t.length-1-r)*l}),s.timestamp=o,s.pvd_level=i,s.readings=t;break}case 10:s.timestamp=(r(e[n++])<<24>>>0)+(r(e[n++])<<16>>>0)+(r(e[n++])<<8>>>0)+r(e[n++]),s.s1MinC=t(e[n++]),s.s1MaxC=t(e[n++]),s.s2MinC=t(e[n++]),s.s2MaxC=t(e[n++]),s.s3MinC=t(e[n++]),s.s3MaxC=t(e[n++]);break;default:throw"Unrecognised type for uplink decoding"}return s}e.exports={Decoder:function(e,t){try{return o(e,t)}catch(e){return null}},decodeUplink:function(e){let t={warnings:[],errors:[]};try{t.data=o(e.bytes,e.fPort)}catch(e){t.errors.push(e)}return t}}}},t={};function r(o){var s=t[o];if(void 0!==s)return s.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};(()=>{"use strict";r.r(o),r.d(o,{decodeDownlink:()=>t.decodeDownlink,decodeUplink:()=>e.decodeUplink,encodeDownlink:()=>t.encodeDownlink,extractPoints:()=>s.n});var e=r(987),t=r(110),s=r(415)})();var s=exports;for(var n in o)s[n]=o[n];o.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();